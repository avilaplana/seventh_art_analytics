{
  "semantic_layer": {
    "version": "1.0",
    "purpose": "Natural language to SQL translation",
    "domain": "Movies, TV, people, localization",
    "global_rules": [
      "Always reason in semantic concepts before SQL",
      "Prefer human-readable labels over IDs",
      "IDs are resolved after query generation",
      "Use bridge tables for many-to-many relationships",
      "Assume filters are AND unless user specifies OR",
      "When a person is mentioned, infer a role if possible"
    ],
    "entities": {
      "title": {
        "table": "title",
        "primary_key": "title_id",
        "description": "A creative work such as a movie, TV series, episode, short, or video game.",
        "attributes": {
          "title_id": "id",
          "title_type_id": "id",
          "primary_title": "string",
          "original_title": "string",
          "release_year": "integer",
          "duration_minutes": "integer",
          "average_rating": "float",
          "number_of_votes": "integer",
          "is_adult": "boolean"
        },
        "relationships": {
          "type": {
            "entity": "title_type",
            "join": "title.title_type_id = title_type.title_type_id"
          },
          "genres": {
            "entity": "genre",
            "via": "genre_title",
            "joins": [
              "title.title_id = genre_title.title_id",
              "genre_title.genre_id = genre.genre_id"
            ]
          },
          "people": {
            "entity": "person",
            "via": "title_person_role",
            "joins": [
              "title.title_id = title_person_role.title_id",
              "title_person_role.person_id = person.person_id"
            ]
          },
          "localization": {
            "entity": "title_localized",
            "join": "title.title_id = title_localized.title_id"
          },
          "episodes": {
            "entity": "title_episode",
            "join": "title.title_id = title_episode.series_title_id"
          }
        }
      },
      "person": {
        "table": "person",
        "primary_key": "person_id",
        "description": "A real person involved in a title (actor, director, writer, etc).",
        "attributes": {
          "person_id": "id",
          "name": "string",
          "birth_year": "integer",
          "death_year": "integer"
        }
      },
      "title_type": {
        "type": "enum",
        "table": "title_type",
        "id_column": "title_type_id",
        "label_column": "title_type_name",
        "values": [
          "movie",
          "short",
          "tvSeries",
          "tvEpisode",
          "tvMiniSeries",
          "tvMovie",
          "tvSpecial",
          "tvShort",
          "tvPilot",
          "video",
          "videoGame"
        ],
        "nl_mappings": {
          "movie": "movie",
          "film": "movie",
          "series": "tvSeries",
          "tv_show": "tvSeries",
          "episode": "tvEpisode",
          "mini_series": "tvMiniSeries",
          "game": "videoGame"
        }
      },
      "genre": {
        "type": "enum",
        "table": "genre",
        "id_column": "genre_id",
        "label_column": "genre_name",
        "values": [
          "Action",
          "Adventure",
          "Animation",
          "Biography",
          "Comedy",
          "Crime",
          "Documentary",
          "Drama",
          "Family",
          "Fantasy",
          "Film-Noir",
          "Game-Show",
          "History",
          "Horror",
          "Music",
          "Musical",
          "Mystery",
          "News",
          "Reality-TV",
          "Romance",
          "Sci-Fi",
          "Short",
          "Sport",
          "Talk-Show",
          "Thriller",
          "War",
          "Western"
        ],
        "rules": [
          "Requires join via genre_title",
          "Multiple genres imply AND unless stated otherwise"
        ]
      },
      "role": {
        "type": "enum",
        "table": "role",
        "id_column": "role_id",
        "label_column": "role_name",
        "groups": {
          "acting": ["actor", "actress", "self"],
          "directing": ["director", "assistant_director"],
          "writing": ["writer"],
          "producing": ["producer", "executive"],
          "music": ["composer", "music_artist"],
          "technical": ["cinematographer", "editor", "visual_effects", "sound_department"]
        },
        "nl_mappings": {
          "acted_in": ["actor", "actress", "self"],
          "starring": ["actor", "actress", "self"],
          "directed_by": ["director"],
          "written_by": ["writer"],
          "produced_by": ["producer"]
        },
        "rules": [
          "Role filters require title_person_role join",
          "Job column is secondary to role_name"
        ]
      },
      "language": {
        "type": "enum",
        "table": "languages",
        "id_column": "language_id",
        "label_column": "language_name",
        "code_column": "language_code",
        "common_languages": ["English", "Spanish", "French", "German", "Italian", "Japanese", "Korean", "Chinese"],
        "aliases": {
          "Farsi": "Persian",
          "Mandarin": "Mandarin Chinese",
          "Cantonese": "Cantonese",
          "Chinese": "Chinese",
          "Dari": "Dari"
        },
        "rules": [
          "Language filters apply to title_localized.language_id",
          "Accept language name or ISO code"
        ]
      },
      "region": {
        "type": "enum",
        "table": "regions",
        "id_column": "region_id",
        "label_column": "region_name",
        "code_column": "region_code",
        "common_regions": ["United States", "United Kingdom", "France", "Spain", "Germany", "Japan"],
        "aliases": {
          "US": "United States",
          "UK": "United Kingdom"
        },
        "rules": [
          "Region filters apply to title_localized.region_id",
          "Region usually refers to release or localization"
        ]
      },
      "title_localized": {
        "table": "title_localized",
        "description": "Localized titles by region and language.",
        "attributes": {
          "title": "string",
          "ordering": "integer",
          "is_original_title": "boolean"
        },
        "relationships": {
          "language": "language",
          "region": "region"
        },
        "nl_rules": {
          "original title": "is_original_title = true",
          "French title": "language = French"
        }
      },
      "canonical_patterns": [
        {
          "intent": "movies by person",
          "interpretation": {
            "entity": "title",
            "filters": {
              "title_type": "movie",
              "person.name": "{person}",
              "role": "inferred"
            }
          }
        },
        {
          "intent": "titles by genre and year",
          "interpretation": {
            "entity": "title",
            "filters": {
              "genre": "{genre}",
              "release_year": "{year_range}"
            }
          }
        },
        {
          "intent": "localized titles",
          "interpretation": {
            "entity": "title",
            "filters": {
              "language": "{language}",
              "region": "{region}"
            }
          }
        }
      ]
    }
  }
}